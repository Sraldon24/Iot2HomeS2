<!-- ============================================ -->
<!-- FILE: web_app/templates/security.html -->
<!-- ============================================ -->
{% extends "base.html" %}
{% block content %}
<h2>ğŸš¨ Security Management</h2>

<div class="card">
  <h3>ğŸ” System Status</h3>
  <div class="status-box {{ 'enabled' if is_enabled else 'disabled' }}">
    <div>{{ 'ğŸŸ¢' if is_enabled else 'ğŸ”´' }}</div>
    <div><strong>{{ 'ENABLED' if is_enabled else 'DISABLED' }}</strong></div>
  </div>
  <form method="POST" style="margin-top: 20px;">
    <button type="submit" name="toggle_security" 
            value="{{ 'disable' if is_enabled else 'enable' }}"
            class="{{ 'btn-disable' if is_enabled else 'btn-enable' }}">
      {{ 'ğŸ”’ Disable' if is_enabled else 'ğŸ”“ Enable' }}
    </button>
  </form>
</div>

<div class="card">
  <h3>ğŸ“… View Intrusions</h3>
  <form method="POST">
    <input type="date" name="date" value="{{ selected_date }}" required>
    <button type="submit">Load</button>
  </form>
  <p>{{ selected_date }}: <strong>{{ total_intrusions }}</strong> intrusions</p>
</div>

<div class="card">
  <h3>ğŸ“‹ Intrusion Log</h3>
  {% if intrusions %}
  <table>
    <tr><th>Time</th><th>Status</th><th>Image</th></tr>
    {% for event in intrusions %}
    <tr>
      <td>{{ event[0] }}</td>
      <td><span class="badge-danger">ğŸ”´ Motion</span></td>
      <td>{{ event[2] if event[2] else '-' }}</td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>âœ… No intrusions on {{ selected_date }}</p>
  {% endif %}
</div>
{% endblock %}